# `za6_moveit_config` package

This package started out generated by `moveit_setup_assistant`, but
the launch files needed enough rework that it no longer seems
worthwhile to attempt to preserve the generated package.

## Run the demo

    ros2 launch za6_moveit_config demo.launch.py

The demo doesn't depend on any robot hardware, and is useful to check
URDFs and planning configuration


## `za6_moveit_config` package creation from scratch

https://moveit.picknik.ai/humble/doc/examples/urdf_srdf/urdf_srdf_tutorial.html

- Build workspace to pick up `za6_description` package
- Verify URDFs (see `za6_description/README.md`)
- Run `ros2 launch moveit_setup_assistant setup_assistant.launch.py`
- "Start" tab:
  - Select "Create New Moveit Configuration Package"
  - Load the `src/tormach/za6/za6_description/urdf/za6.xacro` URDF model
  - Click "Load Files"
- "Self-Collisions" tab:  Adds `disable_collisions` elements to SRDF
  - Click "Generate Collision Matrix"
  - Optionally, disable additional collisions
    - Click "show enabled pairs"
    - Disable additional collisions:
      - base -> 2, 2 -> 4, 4 -> 6 can't collide with joint limits in
        effect (coarse collision models?)
- "Virtual Joints" tab:  Adds `virtual_joint` to SRDF (Skip)
- "Planning Groups" tab:  Adds `group` element to SRDF
  - Add `manipulator` group:  Click "Add Group"
    - "Group Name" "manipulator"
    - "Kinematics Solver" "kdl_kinematics_plugin/KDLKinematicsPlugin"
    - "Group Default Planner" "RRT"
    - Click "Add Kin. Chain"
      - Base Link:  "base_link"
      - Tip Link:  "tool0"
      - Click "Save"
- "Robot Poses" tab:  Adds `group_state` element to SRDF
  - Click "Add Pose"
    - "Pose Name" "all-zeros"
    - Leave other setting default
    - Click "Save"
- "End Effectors" tab:  (Skip)
- "Passive Joints" tab:  (Skip)
- "ros2_control URDF Modifications" tab:  (Skip)
- "ROS 2 Controllers" tab:  Configures `ros_controllers.yaml` file
  - Click "Add Controller"
    - "Controller Name" "joint_trajectory_controller"
    - "Controller Type" "joint_trajectory_controller/JointTrajectoryController"
    - Click "Add Individual Joints"
      - Select "joint_[1-6]"
      - Click ">" to add
      - Click "Save"
- "Moveit Controllers" tab:
  - Click "Add Controller"
    - "Controller Name" "follow_joint_trajectory"
    - "Controller Type" "FollowJointTrajectory"
    - "Action Namespace" "follow_joint_trajectory"
    - "Default" "true"
    - Click "Add Individual Joints"
      - Select "joint_[1-6]"
      - Click ">" to add
      - Click "Save"
- "Perception" tab:  (Skip)
- "Launch Files" tab:  (Skip; use defaults)
- "Author information" tab:
  - Enter name and email
- "Configuration Files" tab:
  - "Configuration Package Save Path"
    "[...]/src/tormach/za6_moveit_config" (Create directory first)
  - Click "Generate Package"
    - Click "Ok" at "Incomplete" warning
  - Click "Exit Setup Assistant"

Test:
```
colcon build && source install/setup.bash
ros2 launch za6_moveit_config demo.launch.py
```
